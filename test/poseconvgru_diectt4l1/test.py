import numpy as np

def get_rel_pos(abs0, abs1, abs2):
    print("for rel",abs0,abs1,abs2)
    if (abs0 == abs1).all():
        return abs2-abs0
    tm1_2_t0 = np.array([abs1[0]-abs0[0], abs1[1]-abs0[1]])
    unit_tm1_2_t0 = tm1_2_t0/np.linalg.norm(tm1_2_t0)
    t0_2_tp1 = np.array([abs2[0]-abs1[0], abs2[1]-abs1[1]])
    x_proj = unit_tm1_2_t0.dot(t0_2_tp1)
    x = unit_tm1_2_t0 * x_proj
    y = t0_2_tp1-x
    y_proj = np.linalg.norm(y)
    if np.cross(x, y) < 0:
        y_proj = -y_proj
    if np.isnan(x_proj):
        x_proj = 0.0
    if np.isnan(y_proj):
        y_proj = 0.0
    return np.array([x_proj, y_proj])

def get_abs_pos(abs0, rel1=None, rel2=None):
    print('for abs',abs0, rel1, rel2)
    if (rel1 == 0).all():
        return abs0+rel2
    else:
        abs1 = abs0 + rel1
        v = np.array([rel1[0], -rel1[1]])
        v = v/np.linalg.norm(v)
        ax = rel2.dot(v)
        ay = rel2 - ax*v
        ay = np.linalg.norm(ay)
        return abs1+np.array([ax,ay])

abss = np.array([
 [ 0.00000000e+00,  0.00000000e+00],
 [ 0.00000000e+00,  0.00000000e+00],
 [ 0.00000000e+00,  0.00000000e+00],
 [-7.62991370e-05,  1.05644226e-01],
 [-1.01780809e-02,  1.30107117e+00],
 [-2.77264932e-02,  3.17753602e+00],
 [-4.03460927e-02,  5.60004426e+00],
 [-6.26402072e-02,  8.17985536e+00],
 [-9.54938920e-02,  1.12292099e+01],
 [-1.21969107e-01,  1.47260514e+01],
 [-2.20347041e-01,  1.81304169e+01],
 [-5.35440258e-01,  2.16229401e+01],
 [-1.15026038e+00,  2.49361115e+01],
 [-2.15412121e+00,  2.82869339e+01],
 [-3.46005891e+00,  3.14365921e+01],
 [-5.03541817e+00,  3.44532319e+01],
 [-6.29519591e+00,  3.64314728e+01],
 [-7.60777911e+00,  3.81871720e+01],
 [-9.30551949e+00,  4.01966248e+01],
 [-1.14367438e+01,  4.23608018e+01],
 [-1.38310647e+01,  4.44232674e+01],
 [-1.67022370e+01,  4.64502755e+01],
 [-1.96790049e+01,  4.81391183e+01],
 [-2.24951439e+01,  4.94546853e+01],
 [-2.32666332e+01,  4.97709351e+01],
 [-2.32676479e+01,  4.97712098e+01],
 [-2.32677318e+01,  4.97712556e+01],
 [-2.32747360e+01,  4.97731782e+01],
 [-2.35968256e+01,  4.98787270e+01],
 [-2.46729859e+01,  5.02126351e+01],
 [-2.63864207e+01,  5.06536103e+01],
 [-2.78929673e+01,  5.10102120e+01],
 [-2.80598527e+01,  5.10464974e+01],
 [-2.85968570e+01,  5.11469575e+01],
 [-2.97277226e+01,  5.13418275e+01],
 [-3.11746046e+01,  5.15423699e+01],
 [-3.26745743e+01,  5.16833421e+01],
 [-3.46623824e+01,  5.18047600e+01],
 [-3.72014242e+01,  5.18788605e+01],
 [-4.00539876e+01,  5.19122811e+01],
 [-4.31581036e+01,  5.19421693e+01],
 [-4.66890428e+01,  5.19837914e+01],
 [-5.00978146e+01,  5.20298348e+01],
 [-5.27890241e+01,  5.20595055e+01],
 [-5.49138013e+01,  5.20748139e+01],
 [-5.70451706e+01,  5.20839539e+01],
 [-5.96434803e+01,  5.20904084e+01],
 [-6.26763498e+01,  5.20919762e+01],
 [-6.58278084e+01,  5.20985184e+01],
 [-6.93668962e+01,  5.21471062e+01],
 [-7.27670158e+01,  5.21875840e+01],
 [-7.62768359e+01,  5.22163316e+01]])

for i in range(2,len(abss)):
    rel_poss = get_rel_pos(abss[i-2],abss[i-1],abss[i])
    abs_poss = get_abs_pos(abss[i-2], abss[i-1]-abss[i-2], rel_poss)

    print('------')
    print(rel_poss)
    print(abs_poss)
    print(abss[i])
    print('------')